(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{19:function(t,e,r){"use strict";var o=r(0),s=r.n(o);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e,r,o,s,n,i){try{var a=t[n](i),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(o,s)}function l(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"===u(t)&&(r=t,t=""),r=i({url:t,title:e,width:600,height:720},r);var o=void 0!==window.screenLeft?window.screenLeft:window.screen.left,s=void 0!==window.screenTop?window.screenTop:window.screen.top,n=window.innerWidth||document.documentElement.clientWidth||window.screen.width,a=window.innerHeight||document.documentElement.clientHeight||window.screen.height;r.left=n/2-r.width/2+o,r.top=a/2-r.height/2+s;var c=Object.keys(r).reduce((function(t,e){return t.push("".concat(e,"=").concat(r[e])),t}),[]).join(","),l=window.open(t,e,c);return window.focus&&l.focus(),l}var m={name:"LoginWithGithub",computed:{githubAuth:function(){return window.config.githubAuth},url:function(){return"/api/oauth/github"}},mounted:function(){window.addEventListener("message",this.onMessage,!1)},beforeDestroy:function(){window.removeEventListener("message",this.onMessage)},methods:{login:function(){var t,e=this;return(t=s.a.mark((function t(){var r,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l("",e.$t("login")),t.next=3,e.$store.dispatch("auth/fetchOauthUrl",{provider:"github"});case 3:o=t.sent,r.location.href=o;case 5:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,s){var n=t.apply(e,r);function i(t){c(n,o,s,i,a,"next",t)}function a(t){c(n,o,s,i,a,"throw",t)}i(void 0)}))})()},onMessage:function(t){t.origin===window.origin&&t.data.token&&(this.$store.dispatch("auth/saveToken",{token:t.data.token}),this.$router.push({name:"home"}))}}},d=r(1),f=Object(d.a)(m,(function(){var t=this.$createElement,e=this._self._c||t;return this.githubAuth?e("button",{staticClass:"btn btn-dark ml-auto",attrs:{type:"button"},on:{click:this.login}},[this._v("\n  "+this._s(this.$t("login_with"))+"\n  "),e("fa",{attrs:{icon:["fab","github"]}})],1):this._e()}),[],!1,null,null,null);e.a=f.exports},27:function(t,e,r){"use strict";r.r(e);var o=r(0),s=r.n(o),n=r(3),i=r.n(n),a=r(19),u=r(4),c={name:"Card",middleware:"guest",props:{title:{type:String,default:null},submit:{type:Function},form:{type:FormData}},data:function(){return{secQs:[[],[],[]]}},components:{},computed:Object(u.b)({userSecurityQuestions:"user-security-question/userSecurityQuestions",userSecurityQuestionForm:"user-security-question/userSecurityQuestionForm"}),methods:{onChange:function(t,e){for(var r=parseInt(t.target.value),o=0;o<this.secQs.length;o++)o!==e&&(this.secQs[o]=this.userSecurityQuestions,this.secQs[o]=this.secQs[o].filter((function(t){return t.id!==r})))}},beforeMount:function(){console.log(this.userSecurityQuestions);for(var t=0;t<this.secQs.length;t++)this.secQs[t]=this.userSecurityQuestions}},l=r(1),m=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t._m(0),t._v(" "),r("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)},keydown:function(e){return t.userSecurityQuestionForm.onKeydown(e)}}},[r("div",{staticClass:"form-group col-md-12 px-0"},[r("label",{attrs:{for:"firstQuestion"}},[t._v("First Question")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.userSecurityQuestionForm.question_1,expression:"userSecurityQuestionForm.question_1"}],staticClass:"form-control",attrs:{id:"firstQuestion",required:""},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.userSecurityQuestionForm,"question_1",e.target.multiple?r:r[0])},function(e){return t.onChange(e,0)}]}},t._l(t.secQs[0],(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                  "+t._s(e.question)+"\n            ")])})),0)]),t._v(" "),r("div",{staticClass:"form-group col-md-12 px-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.userSecurityQuestionForm.answer_1,expression:"userSecurityQuestionForm.answer_1"}],staticClass:"form-control",attrs:{placeholder:"Answer",type:"text",name:"answer_1"},domProps:{value:t.userSecurityQuestionForm.answer_1},on:{input:function(e){e.target.composing||t.$set(t.userSecurityQuestionForm,"answer_1",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-group col-md-12 px-0"},[r("label",{attrs:{for:"firstQuestion"}},[t._v("Second Question")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.userSecurityQuestionForm.question_2,expression:"userSecurityQuestionForm.question_2"}],staticClass:"form-control",attrs:{id:"firstQuestion",required:""},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.userSecurityQuestionForm,"question_2",e.target.multiple?r:r[0])},function(e){return t.onChange(e,1)}]}},t._l(t.secQs[1],(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                  "+t._s(e.question)+"\n            ")])})),0)]),t._v(" "),r("div",{staticClass:"form-group col-md-12 px-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.userSecurityQuestionForm.answer_2,expression:"userSecurityQuestionForm.answer_2"}],staticClass:"form-control",attrs:{placeholder:"Answer",type:"text",name:"answer_2"},domProps:{value:t.userSecurityQuestionForm.answer_2},on:{input:function(e){e.target.composing||t.$set(t.userSecurityQuestionForm,"answer_2",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-group col-md-12 px-0"},[r("label",{attrs:{for:"firstQuestion"}},[t._v("Third Question")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.userSecurityQuestionForm.question_3,expression:"userSecurityQuestionForm.question_3"}],staticClass:"form-control",attrs:{id:"firstQuestion",required:""},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.userSecurityQuestionForm,"question_3",e.target.multiple?r:r[0])},function(e){return t.onChange(e,2)}]}},t._l(t.secQs[2],(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                  "+t._s(e.question)+"\n            ")])})),0)]),t._v(" "),r("div",{staticClass:"form-group col-md-12 px-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.userSecurityQuestionForm.answer_3,expression:"userSecurityQuestionForm.answer_3"}],staticClass:"form-control",attrs:{placeholder:"Answer",type:"text",name:"answer_3"},domProps:{value:t.userSecurityQuestionForm.answer_3},on:{input:function(e){e.target.composing||t.$set(t.userSecurityQuestionForm,"answer_3",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-group col-md-12 px-0 mt-3"},[r("div",{staticClass:"col-md-12 px-0"},[r("v-button",{staticClass:"btn btn-primary w-100",attrs:{loading:t.form.busy}},[t._v("\n                "+t._s(t.$t("register"))+"\n            ")])],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"w-100 text-center mt-2 mb-4"},[e("h4",[this._v("Security Questions")]),this._v(" "),e("hr",{staticClass:"mx-auto line-form-break"})])}],!1,null,null,null).exports,d=r(7),f=r.n(d),p=r(17),v=r.n(p),h=r(6),_=r.n(h),w=r(40),y=r.n(w),b=(r(64),r(8)),g=r.n(b);function x(t,e,r,o,s,n,i){try{var a=t[n](i),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(o,s)}f.a.component("vue-phone-number-input",y.a);var C={layout:"auth",middleware:"guest",components:{LoginWithGithub:a.a,SecurityQuestion:m,VuePhoneNumberInput:y.a,VueHcaptcha:v.a},mounted:function(){this.$store.dispatch("user-security-question/fetchUserSecurityQuestions")},metaInfo:function(){return{title:this.$t("register")}},data:function(){return{form:new i.a({username:"",name:"",phone_number:"",email:"",password:"",password_confirmation:"",validate:null}),phone_number:"",validPhoneNumber:!1,mustVerifyEmail:!1,onSecurity:!1,srcLogoOnly:window.config.assetURL+"images/sample-logo.png",token:null,step:0,userData:null}},methods:{updatePhoneNumber:function(t){console.log(t),this.form.phone_number=t.e164,t.isValid&&(this.validPhoneNumber=!0)},prev:function(){this.step--},next:function(){this.step++},register:function(){var t,e=this;return(t=s.a.mark((function t(){var r,o,n,i,a,u,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.form.post("/api/register").catch((function(t){var r=Object.keys(t.response.data.errors).length;switch(Object.keys(t.response.data.errors)[0]){case"name":case"username":e.step=0;break;case"email":case"password":case"phone":e.step=1}1==r&&(e.onSecurity=!0,e.form.validate=!0)}));case 2:if(r=t.sent,o=r.data,e.userData=o,!o){t.next=17;break}return e.$store.dispatch("user-security-question/saveUserSecurityQuestion",e.userData.id),n={email:e.form.email,data:{fullName:e.form.name,userName:e.form.username,email:e.form.email}},i=_.a.post("api/email/send-email",n),a=i.emailRes,console.log(a),t.next=12,e.form.post("/api/login");case 12:u=t.sent,c=u.data.token,e.$store.dispatch("auth/saveToken",{token:c}),e.$store.dispatch("auth/updateUser",{user:o}),g.a.fire({title:"Success",text:"A verification code has been sent to your phone number!",type:"success"}).then((function(){e.$router.push({name:"user.verify"})}));case 17:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,s){var n=t.apply(e,r);function i(t){x(n,o,s,i,a,"next",t)}function a(t){x(n,o,s,i,a,"throw",t)}i(void 0)}))})()},isVerified:function(t){this.token=t}}},Q=Object(l.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row h-100"},[t.onSecurity?t._e():r("div",{staticClass:"col-lg-12 my-auto"},[t.mustVerifyEmail?r("div",[r("div",{staticClass:"alert alert-success",attrs:{role:"alert"}},[t._v("\n        "+t._s(t.$t("verify_email_address"))+"\n      ")])]):r("div",[r("div",{staticClass:"w-100 text-center mt-2 mb-4"},[r("img",{staticClass:"img-fluid col-12 col-lg-4",staticStyle:{"mix-blend-mode":"luminosity"},attrs:{src:t.srcLogoOnly,srcset:""}}),t._v(" "),r("hr",{staticClass:"mx-auto line-form-break"}),t._v(" "),r("h4",[t._v("Register")])]),t._v(" "),r("form",{on:{submit:function(e){return e.preventDefault(),t.register(e)},keydown:function(e){return t.form.onKeydown(e)}}},[0===t.step?r("div",[r("div",{staticClass:"form-group col-md-7 mx-auto"},[r("label",[t._v(t._s(t.$t("username")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.username,expression:"form.username"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("username")},attrs:{type:"text",name:"username"},domProps:{value:t.form.username},on:{input:function(e){e.target.composing||t.$set(t.form,"username",e.target.value)}}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:"username"}})],1),t._v(" "),r("div",{staticClass:"form-group col-md-7 mx-auto"},[r("label",[t._v(t._s(t.$t("name")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("name")},attrs:{type:"text",name:"name"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:"name"}})],1),t._v(" "),r("div",{staticClass:"form-group row col-md-7 mx-auto mt-3"},[r("div",{staticClass:"col-md-6 px-0 pr-lg-1"},[r("router-link",{attrs:{to:"/login"}},[r("button",{staticClass:"btn btn-secondary w-100",attrs:{type:"button"}},[t._v("\n                Cancel\n              ")])])],1),t._v(" "),r("div",{staticClass:"col-md-6 px-0 pl-lg-1"},[r("button",{staticClass:"btn btn-primary w-100",attrs:{type:"button",disabled:""===t.form.name||""===t.form.username},on:{click:function(e){return e.preventDefault(),t.next()}}},[t._v("\n                Next\n              ")])])])]):t._e(),t._v(" "),1===t.step?r("div",[r("div",{staticClass:"form-group col-md-7 mx-auto"},[r("label",[t._v(t._s(t.$t("email")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("email")},attrs:{type:"text",name:"email"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:"email"}})],1),t._v(" "),r("div",{staticClass:"form-group col-md-7 mx-auto"},[r("label",[t._v(t._s(t.$t("password")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("password")},attrs:{type:"text",name:"password"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:"password"}})],1),t._v(" "),r("div",{staticClass:"form-group col-md-7 mx-auto"},[r("label",[t._v(t._s(t.$t("confirm_password")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password_confirmation,expression:"form.password_confirmation"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("password_confirmation")},attrs:{type:"text",name:"password_confirmation"},domProps:{value:t.form.password_confirmation},on:{input:function(e){e.target.composing||t.$set(t.form,"password_confirmation",e.target.value)}}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:"password_confirmation"}})],1),t._v(" "),r("div",{staticClass:"form-group row col-md-7 mx-auto mt-3"},[r("div",{staticClass:"col-md-6 px-0 pr-lg-1"},[r("button",{staticClass:"btn btn-secondary w-100",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.prev()}}},[t._v("\n                  Back\n                ")])]),t._v(" "),r("div",{staticClass:"col-md-6 px-0 pl-lg-1"},[r("button",{staticClass:"btn btn-primary w-100",attrs:{type:"button",disabled:""===t.form.email||""===t.form.password||""===t.form.password_confirmation},on:{click:function(e){return e.preventDefault(),t.next()}}},[t._v("\n                  Next\n                ")])])])]):t._e(),t._v(" "),2===t.step?r("div",[r("div",{staticClass:"form-group col-md-7 mx-auto"},[r("label",[t._v("Phone Number")]),t._v(" "),r("VuePhoneNumberInput",{class:{"is-invalid":t.form.errors.has("phone_number")},attrs:{"no-flags":"",name:"phone_number"},on:{update:t.updatePhoneNumber},model:{value:t.phone_number,callback:function(e){t.phone_number=e},expression:"phone_number"}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:"phone_number"}})],1),t._v(" "),r("div",{staticClass:"form-group row col-md-7 mx-auto"},[r("div",{staticClass:"col-md-12 px-0"},[r("vue-hcaptcha",{staticClass:"w-100",attrs:{sitekey:"3f7f821f-05b7-486b-a3d9-21395609a73e"},on:{verify:t.isVerified}})],1)]),t._v(" "),r("div",{staticClass:"form-group row col-md-7 mx-auto mt-3"},[r("div",{staticClass:"col-md-6 px-0 pr-lg-1"},[r("button",{staticClass:"btn btn-secondary w-100",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.prev()}}},[t._v("\n                Back\n              ")])]),t._v(" "),r("div",{staticClass:"col-md-6 px-0 pl-lg-1"},[r("v-button",{staticClass:"btn btn-primary w-100",attrs:{loading:t.form.busy,disabled:!t.validPhoneNumber}},[t._v("\n                Next\n              ")])],1)])]):t._e()])])]),t._v(" "),t.onSecurity?r("div",{staticClass:"col-md-7 m-auto"},[r("div",{attrs:{title:"Security Questions"}},[r("SecurityQuestion",{attrs:{submit:t.register,form:t.form}})],1)]):t._e()])}),[],!1,null,null,null);e.default=Q.exports}}]);